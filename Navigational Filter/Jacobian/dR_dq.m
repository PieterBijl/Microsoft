function [dH_dq]=dH_dq(q,xyz)
dH_dq_1=[2*q(1) -2*q(4) 2*q(3);
         2*q(4) 2*q(1) -2*q(2);
         -2*q(3) 2*q(2) 2*q(1)];
dH_dq_2=[2*q(2) 2*q(3) 2*q(4);
         2*q(3) -2*q(2) -2*q(1);
         2*q(4) 2*q(1) -2*q(2)];
dH_dq_3=[-2*q(3) 2*q(2) 2*q(1);
         2*q(2) 2*q(3) 2*q(4);
         -2*q(1) 2*q(4) -2*q(3)];
dH_dq_4=[-2*q(4) -2*q(1) 2*q(2);
         2*q(1) -2*q(4) 2*q(3);
         2*q(1) 2*q(3) 2*q(4)];
dH_dq=dH_dq_1+dH_dq_2+dH_dq_3+dH_dq_4;
end