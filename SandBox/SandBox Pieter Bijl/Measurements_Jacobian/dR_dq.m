function [dR_dq]=dR_dq(q)
dR_dq_1=[2*q(1) -2*q(4) 2*q(3);
         2*q(4) 2*q(1) -2*q(2);
         -2*q(3) 2*q(2) 2*q(1)];
dR_dq_2=[2*q(2) 2*q(3) 2*q(4);
         2*q(3) -2*q(2) -2*q(1);
         2*q(4) 2*q(1) -2*q(2)];
dR_dq_3=[-2*q(3) 2*q(2) 2*q(1);
         2*q(2) 2*q(3) 2*q(4);
         -2*q(1) 2*q(4) -2*q(3)];
dR_dq_4=[-2*q(4) -2*q(1) 2*q(2);
         2*q(1) -2*q(4) 2*q(3);
         2*q(1) 2*q(3) 2*q(4)];
dR_dq=dR_dq_1+dR_dq_2+dR_dq_3+dR_dq_4;
end